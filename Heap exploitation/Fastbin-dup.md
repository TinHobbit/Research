# Table of Contents

-	[Fastbin duplicate](#Fastbin-duplicate)
-	[Example](#Example)

# Fastbin duplicate

-	kĩ thuật này được thực hiện bằng cách exploit vào list của fastbin
	-	khi 1 ứng dụng request giải phóng các memory trùng với memory nằm trong list fastbin, thì allocator sẽ đặt chunk đó vào list
	-	nếu bạn request nhiều lần allocate bộ nhớ duplicate với các chunks đã đặt trong list, thì allocator sẽ trỏ vào chunk bị duplicate đó
	-	kĩ thuật này chỉ được dùng trong fastbin
-	ví dụ bạn request malloc() để allocate 112 bytes 3 lần 
	-	khi application gọi free() với chunk đầu tiên(rõ hơn là con trỏ trỏ tới) làm argument, thì allocator sẽ đặt chunk đó vào fastbin[6]
	-	và khi application gọi free() lần 2, allocator sẽ đặt chunk đó vào `fd` của chunk nằm ở fastbin[6]
	-	khi bạn request để giải phóng chunk đầu tiên đã được free, thì chunk sẽ được đặt vào cuối list của fastbin[6]
-	application request malloc() allocate memory bằng với memory đã được free.
	-	1st request, memory cuối cùng trong fastbin sẽ được reallocate
	-	2nd request, memory kế tiếp sẽ được allocate
	-	3rd request, memory giống với 1st request sẽ được allocate

nói cách khác, con trỏ trỏ đến 1st và 3rd là giống nhau
![visualize](https://i.imgur.com/cmaxWqA.png)

# Example

```c
#include <stdio.h>
#include <stdlib.h>
  
int main()
{
        int *buf1 = malloc(24);
        int *buf2 = malloc(24);
        int *buf3 = malloc(24);
  
        free(buf1);
        free(buf2);
        free(buf1);
  
        int *buf4 = malloc(24);
        int *buf5 = malloc(24);
        
        int *buf6 = malloc(24);
        return 0;
}
```
